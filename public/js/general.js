/* SWFObject v2.1 <http://code.google.com/p/swfobject/>
	Copyright (c) 2007-2008 Geoff Stearns, Michael Williams, and Bobby van der Sluis
	This software is released under the MIT License <http://www.opensource.org/licenses/mit-license.php>
*/
var swfobject=function(){var b="undefined",Q="object",n="Shockwave Flash",p="ShockwaveFlash.ShockwaveFlash",P="application/x-shockwave-flash",m="SWFObjectExprInst",j=window,K=document,T=navigator,o=[],N=[],i=[],d=[],J,Z=null,M=null,l=null,e=false,A=false;var h=function(){var v=typeof K.getElementById!=b&&typeof K.getElementsByTagName!=b&&typeof K.createElement!=b,AC=[0,0,0],x=null;if(typeof T.plugins!=b&&typeof T.plugins[n]==Q){x=T.plugins[n].description;if(x&&!(typeof T.mimeTypes!=b&&T.mimeTypes[P]&&!T.mimeTypes[P].enabledPlugin)){x=x.replace(/^.*\s+(\S+\s+\S+$)/,"$1");AC[0]=parseInt(x.replace(/^(.*)\..*$/,"$1"),10);AC[1]=parseInt(x.replace(/^.*\.(.*)\s.*$/,"$1"),10);AC[2]=/r/.test(x)?parseInt(x.replace(/^.*r(.*)$/,"$1"),10):0}}else{if(typeof j.ActiveXObject!=b){var y=null,AB=false;try{y=new ActiveXObject(p+".7")}catch(t){try{y=new ActiveXObject(p+".6");AC=[6,0,21];y.AllowScriptAccess="always"}catch(t){if(AC[0]==6){AB=true}}if(!AB){try{y=new ActiveXObject(p)}catch(t){}}}if(!AB&&y){try{x=y.GetVariable("$version");if(x){x=x.split(" ")[1].split(",");AC=[parseInt(x[0],10),parseInt(x[1],10),parseInt(x[2],10)]}}catch(t){}}}}var AD=T.userAgent.toLowerCase(),r=T.platform.toLowerCase(),AA=/webkit/.test(AD)?parseFloat(AD.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,q=false,z=r?/win/.test(r):/win/.test(AD),w=r?/mac/.test(r):/mac/.test(AD);/*@cc_on q=true;@if(@_win32)z=true;@elif(@_mac)w=true;@end@*/return{w3cdom:v,pv:AC,webkit:AA,ie:q,win:z,mac:w}}();var L=function(){if(!h.w3cdom){return }f(H);if(h.ie&&h.win){try{K.write("<script id=__ie_ondomload defer=true src=//:><\/script>");J=C("__ie_ondomload");if(J){I(J,"onreadystatechange",S)}}catch(q){}}if(h.webkit&&typeof K.readyState!=b){Z=setInterval(function(){if(/loaded|complete/.test(K.readyState)){E()}},10)}if(typeof K.addEventListener!=b){K.addEventListener("DOMContentLoaded",E,null)}R(E)}();function S(){if(J.readyState=="complete"){J.parentNode.removeChild(J);E()}}function E(){if(e){return }if(h.ie&&h.win){var v=a("span");try{var u=K.getElementsByTagName("body")[0].appendChild(v);u.parentNode.removeChild(u)}catch(w){return }}e=true;if(Z){clearInterval(Z);Z=null}var q=o.length;for(var r=0;r<q;r++){o[r]()}}function f(q){if(e){q()}else{o[o.length]=q}}function R(r){if(typeof j.addEventListener!=b){j.addEventListener("load",r,false)}else{if(typeof K.addEventListener!=b){K.addEventListener("load",r,false)}else{if(typeof j.attachEvent!=b){I(j,"onload",r)}else{if(typeof j.onload=="function"){var q=j.onload;j.onload=function(){q();r()}}else{j.onload=r}}}}}function H(){var t=N.length;for(var q=0;q<t;q++){var u=N[q].id;if(h.pv[0]>0){var r=C(u);if(r){N[q].width=r.getAttribute("width")?r.getAttribute("width"):"0";N[q].height=r.getAttribute("height")?r.getAttribute("height"):"0";if(c(N[q].swfVersion)){if(h.webkit&&h.webkit<312){Y(r)}W(u,true)}else{if(N[q].expressInstall&&!A&&c("6.0.65")&&(h.win||h.mac)){k(N[q])}else{O(r)}}}}else{W(u,true)}}}function Y(t){var q=t.getElementsByTagName(Q)[0];if(q){var w=a("embed"),y=q.attributes;if(y){var v=y.length;for(var u=0;u<v;u++){if(y[u].nodeName=="DATA"){w.setAttribute("src",y[u].nodeValue)}else{w.setAttribute(y[u].nodeName,y[u].nodeValue)}}}var x=q.childNodes;if(x){var z=x.length;for(var r=0;r<z;r++){if(x[r].nodeType==1&&x[r].nodeName=="PARAM"){w.setAttribute(x[r].getAttribute("name"),x[r].getAttribute("value"))}}}t.parentNode.replaceChild(w,t)}}function k(w){A=true;var u=C(w.id);if(u){if(w.altContentId){var y=C(w.altContentId);if(y){M=y;l=w.altContentId}}else{M=G(u)}if(!(/%$/.test(w.width))&&parseInt(w.width,10)<310){w.width="310"}if(!(/%$/.test(w.height))&&parseInt(w.height,10)<137){w.height="137"}K.title=K.title.slice(0,47)+" - Flash Player Installation";var z=h.ie&&h.win?"ActiveX":"PlugIn",q=K.title,r="MMredirectURL="+j.location+"&MMplayerType="+z+"&MMdoctitle="+q,x=w.id;if(h.ie&&h.win&&u.readyState!=4){var t=a("div");x+="SWFObjectNew";t.setAttribute("id",x);u.parentNode.insertBefore(t,u);u.style.display="none";var v=function(){u.parentNode.removeChild(u)};I(j,"onload",v)}U({data:w.expressInstall,id:m,width:w.width,height:w.height},{flashvars:r},x)}}function O(t){if(h.ie&&h.win&&t.readyState!=4){var r=a("div");t.parentNode.insertBefore(r,t);r.parentNode.replaceChild(G(t),r);t.style.display="none";var q=function(){t.parentNode.removeChild(t)};I(j,"onload",q)}else{t.parentNode.replaceChild(G(t),t)}}function G(v){var u=a("div");if(h.win&&h.ie){u.innerHTML=v.innerHTML}else{var r=v.getElementsByTagName(Q)[0];if(r){var w=r.childNodes;if(w){var q=w.length;for(var t=0;t<q;t++){if(!(w[t].nodeType==1&&w[t].nodeName=="PARAM")&&!(w[t].nodeType==8)){u.appendChild(w[t].cloneNode(true))}}}}}return u}function U(AG,AE,t){var q,v=C(t);if(v){if(typeof AG.id==b){AG.id=t}if(h.ie&&h.win){var AF="";for(var AB in AG){if(AG[AB]!=Object.prototype[AB]){if(AB.toLowerCase()=="data"){AE.movie=AG[AB]}else{if(AB.toLowerCase()=="styleclass"){AF+=' class="'+AG[AB]+'"'}else{if(AB.toLowerCase()!="classid"){AF+=" "+AB+'="'+AG[AB]+'"'}}}}}var AD="";for(var AA in AE){if(AE[AA]!=Object.prototype[AA]){AD+='<param name="'+AA+'" value="'+AE[AA]+'" />'}}v.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+AF+">"+AD+"</object>";i[i.length]=AG.id;q=C(AG.id)}else{if(h.webkit&&h.webkit<312){var AC=a("embed");AC.setAttribute("type",P);for(var z in AG){if(AG[z]!=Object.prototype[z]){if(z.toLowerCase()=="data"){AC.setAttribute("src",AG[z])}else{if(z.toLowerCase()=="styleclass"){AC.setAttribute("class",AG[z])}else{if(z.toLowerCase()!="classid"){AC.setAttribute(z,AG[z])}}}}}for(var y in AE){if(AE[y]!=Object.prototype[y]){if(y.toLowerCase()!="movie"){AC.setAttribute(y,AE[y])}}}v.parentNode.replaceChild(AC,v);q=AC}else{var u=a(Q);u.setAttribute("type",P);for(var x in AG){if(AG[x]!=Object.prototype[x]){if(x.toLowerCase()=="styleclass"){u.setAttribute("class",AG[x])}else{if(x.toLowerCase()!="classid"){u.setAttribute(x,AG[x])}}}}for(var w in AE){if(AE[w]!=Object.prototype[w]&&w.toLowerCase()!="movie"){F(u,w,AE[w])}}v.parentNode.replaceChild(u,v);q=u}}}return q}function F(t,q,r){var u=a("param");u.setAttribute("name",q);u.setAttribute("value",r);t.appendChild(u)}function X(r){var q=C(r);if(q&&(q.nodeName=="OBJECT"||q.nodeName=="EMBED")){if(h.ie&&h.win){if(q.readyState==4){B(r)}else{j.attachEvent("onload",function(){B(r)})}}else{q.parentNode.removeChild(q)}}}function B(t){var r=C(t);if(r){for(var q in r){if(typeof r[q]=="function"){r[q]=null}}r.parentNode.removeChild(r)}}function C(t){var q=null;try{q=K.getElementById(t)}catch(r){}return q}function a(q){return K.createElement(q)}function I(t,q,r){t.attachEvent(q,r);d[d.length]=[t,q,r]}function c(t){var r=h.pv,q=t.split(".");q[0]=parseInt(q[0],10);q[1]=parseInt(q[1],10)||0;q[2]=parseInt(q[2],10)||0;return(r[0]>q[0]||(r[0]==q[0]&&r[1]>q[1])||(r[0]==q[0]&&r[1]==q[1]&&r[2]>=q[2]))?true:false}function V(v,r){if(h.ie&&h.mac){return }var u=K.getElementsByTagName("head")[0],t=a("style");t.setAttribute("type","text/css");t.setAttribute("media","screen");if(!(h.ie&&h.win)&&typeof K.createTextNode!=b){t.appendChild(K.createTextNode(v+" {"+r+"}"))}u.appendChild(t);if(h.ie&&h.win&&typeof K.styleSheets!=b&&K.styleSheets.length>0){var q=K.styleSheets[K.styleSheets.length-1];if(typeof q.addRule==Q){q.addRule(v,r)}}}function W(t,q){var r=q?"visible":"hidden";if(e&&C(t)){C(t).style.visibility=r}else{V("#"+t,"visibility:"+r)}}function g(s){var r=/[\\\"<>\.;]/;var q=r.exec(s)!=null;return q?encodeURIComponent(s):s}var D=function(){if(h.ie&&h.win){window.attachEvent("onunload",function(){var w=d.length;for(var v=0;v<w;v++){d[v][0].detachEvent(d[v][1],d[v][2])}var t=i.length;for(var u=0;u<t;u++){X(i[u])}for(var r in h){h[r]=null}h=null;for(var q in swfobject){swfobject[q]=null}swfobject=null})}}();return{registerObject:function(u,q,t){if(!h.w3cdom||!u||!q){return }var r={};r.id=u;r.swfVersion=q;r.expressInstall=t?t:false;N[N.length]=r;W(u,false)},getObjectById:function(v){var q=null;if(h.w3cdom){var t=C(v);if(t){var u=t.getElementsByTagName(Q)[0];if(!u||(u&&typeof t.SetVariable!=b)){q=t}else{if(typeof u.SetVariable!=b){q=u}}}}return q},embedSWF:function(x,AE,AB,AD,q,w,r,z,AC){if(!h.w3cdom||!x||!AE||!AB||!AD||!q){return }AB+="";AD+="";if(c(q)){W(AE,false);var AA={};if(AC&&typeof AC===Q){for(var v in AC){if(AC[v]!=Object.prototype[v]){AA[v]=AC[v]}}}AA.data=x;AA.width=AB;AA.height=AD;var y={};if(z&&typeof z===Q){for(var u in z){if(z[u]!=Object.prototype[u]){y[u]=z[u]}}}if(r&&typeof r===Q){for(var t in r){if(r[t]!=Object.prototype[t]){if(typeof y.flashvars!=b){y.flashvars+="&"+t+"="+r[t]}else{y.flashvars=t+"="+r[t]}}}}f(function(){U(AA,y,AE);if(AA.id==AE){W(AE,true)}})}else{if(w&&!A&&c("6.0.65")&&(h.win||h.mac)){A=true;W(AE,false);f(function(){var AF={};AF.id=AF.altContentId=AE;AF.width=AB;AF.height=AD;AF.expressInstall=w;k(AF)})}}},getFlashPlayerVersion:function(){return{major:h.pv[0],minor:h.pv[1],release:h.pv[2]}},hasFlashPlayerVersion:c,createSWF:function(t,r,q){if(h.w3cdom){return U(t,r,q)}else{return undefined}},removeSWF:function(q){if(h.w3cdom){X(q)}},createCSS:function(r,q){if(h.w3cdom){V(r,q)}},addDomLoadEvent:f,addLoadEvent:R,getQueryParamValue:function(v){var u=K.location.search||K.location.hash;if(v==null){return g(u)}if(u){var t=u.substring(1).split("&");for(var r=0;r<t.length;r++){if(t[r].substring(0,t[r].indexOf("="))==v){return g(t[r].substring((t[r].indexOf("=")+1)))}}}return""},expressInstallCallback:function(){if(A&&M){var q=C(m);if(q){q.parentNode.replaceChild(M,q);if(l){W(l,true);if(h.ie&&h.win){M.style.display="block"}}M=null;l=null;A=false}}}}}();/*
Uploadify v2.1.0
Release Date: August 24, 2009

Copyright (c) 2009 Ronnie Garcia, Travis Nickels

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
*/

if(jQuery){(function(a){a.extend(a.fn,{uploadify:function(b){a(this).each(function(){settings=a.extend({id:a(this).attr("id"),uploader:"uploadify.swf",script:"uploadify.php",expressInstall:null,folder:"",height:30,width:110,cancelImg:"cancel.png",wmode:"opaque",scriptAccess:"sameDomain",fileDataName:"Filedata",method:"POST",queueSizeLimit:999,simUploadLimit:1,queueID:false,displayData:"percentage",onInit:function(){},onSelect:function(){},onQueueFull:function(){},onCheck:function(){},onCancel:function(){},onError:function(){},onProgress:function(){},onComplete:function(){},onAllComplete:function(){}},b);var e=location.pathname;e=e.split("/");e.pop();e=e.join("/")+"/";var f={};f.uploadifyID=settings.id;f.pagepath=e;if(settings.buttonImg){f.buttonImg=escape(settings.buttonImg)}if(settings.buttonText){f.buttonText=escape(settings.buttonText)}if(settings.rollover){f.rollover=true}f.script=settings.script;f.folder=escape(settings.folder);if(settings.scriptData){var g="";for(var d in settings.scriptData){g+="&"+d+"="+settings.scriptData[d]}f.scriptData=escape(g.substr(1))}f.width=settings.width;f.height=settings.height;f.wmode=settings.wmode;f.method=settings.method;f.queueSizeLimit=settings.queueSizeLimit;f.simUploadLimit=settings.simUploadLimit;if(settings.hideButton){f.hideButton=true}if(settings.fileDesc){f.fileDesc=settings.fileDesc}if(settings.fileExt){f.fileExt=settings.fileExt}if(settings.multi){f.multi=true}if(settings.auto){f.auto=true}if(settings.sizeLimit){f.sizeLimit=settings.sizeLimit}if(settings.checkScript){f.checkScript=settings.checkScript}if(settings.fileDataName){f.fileDataName=settings.fileDataName}if(settings.queueID){f.queueID=settings.queueID}if(settings.onInit()!==false){a(this).css("display","none");a(this).after('<div id="'+a(this).attr("id")+'Uploader"></div>');swfobject.embedSWF(settings.uploader,settings.id+"Uploader",settings.width,settings.height,"9.0.24",settings.expressInstall,f,{quality:"high",wmode:settings.wmode,allowScriptAccess:settings.scriptAccess});if(settings.queueID==false){a("#"+a(this).attr("id")+"Uploader").after('<div id="'+a(this).attr("id")+'Queue" class="uploadifyQueue"></div>')}}if(typeof(settings.onOpen)=="function"){a(this).bind("uploadifyOpen",settings.onOpen)}a(this).bind("uploadifySelect",{action:settings.onSelect,queueID:settings.queueID},function(j,h,i){if(j.data.action(j,h,i)!==false){var k=Math.round(i.size/1024*100)*0.01;var l="KB";if(k>1000){k=Math.round(k*0.001*100)*0.01;l="MB"}var m=k.toString().split(".");if(m.length>1){k=m[0]+"."+m[1].substr(0,2)}else{k=m[0]}if(i.name.length>20){fileName=i.name.substr(0,20)+"..."}else{fileName=i.name}queue="#"+a(this).attr("id")+"Queue";if(j.data.queueID){queue="#"+j.data.queueID}a(queue).append('<div id="'+a(this).attr("id")+h+'" class="uploadifyQueueItem"><div class="cancel"><a href="javascript:jQuery(\'#'+a(this).attr("id")+"').uploadifyCancel('"+h+'\')"><img src="'+settings.cancelImg+'" border="0" /></a></div><span class="fileName">'+fileName+" ("+k+l+')</span><span class="percentage"></span><div class="uploadifyProgress"><div id="'+a(this).attr("id")+h+'ProgressBar" class="uploadifyProgressBar"><!--Progress Bar--></div></div></div>')}});if(typeof(settings.onSelectOnce)=="function"){a(this).bind("uploadifySelectOnce",settings.onSelectOnce)}a(this).bind("uploadifyQueueFull",{action:settings.onQueueFull},function(h,i){if(h.data.action(h,i)!==false){alert("The queue is full.  The max size is "+i+".")}});a(this).bind("uploadifyCheckExist",{action:settings.onCheck},function(m,l,k,j,o){var i=new Object();i=k;i.folder=e+j;if(o){for(var h in k){var n=h}}a.post(l,i,function(r){for(var p in r){if(m.data.action(m,l,k,j,o)!==false){var q=confirm("Do you want to replace the file "+r[p]+"?");if(!q){document.getElementById(a(m.target).attr("id")+"Uploader").cancelFileUpload(p,true,true)}}}if(o){document.getElementById(a(m.target).attr("id")+"Uploader").startFileUpload(n,true)}else{document.getElementById(a(m.target).attr("id")+"Uploader").startFileUpload(null,true)}},"json")});a(this).bind("uploadifyCancel",{action:settings.onCancel},function(l,h,k,m,j){if(l.data.action(l,h,k,m,j)!==false){var i=(j==true)?0:250;a("#"+a(this).attr("id")+h).fadeOut(i,function(){a(this).remove()})}});if(typeof(settings.onClearQueue)=="function"){a(this).bind("uploadifyClearQueue",settings.onClearQueue)}var c=[];a(this).bind("uploadifyError",{action:settings.onError},function(l,h,k,j){if(l.data.action(l,h,k,j)!==false){var i=new Array(h,k,j);c.push(i);a("#"+a(this).attr("id")+h+" .percentage").text(" - "+j.type+" Error");a("#"+a(this).attr("id")+h).addClass("uploadifyError")}});a(this).bind("uploadifyProgress",{action:settings.onProgress,toDisplay:settings.displayData},function(j,h,i,k){if(j.data.action(j,h,i,k)!==false){a("#"+a(this).attr("id")+h+"ProgressBar").css("width",k.percentage+"%");if(j.data.toDisplay=="percentage"){displayData=" - "+k.percentage+"%"}if(j.data.toDisplay=="speed"){displayData=" - "+k.speed+"KB/s"}if(j.data.toDisplay==null){displayData=" "}a("#"+a(this).attr("id")+h+" .percentage").text(displayData)}});a(this).bind("uploadifyComplete",{action:settings.onComplete},function(k,h,j,i,l){if(k.data.action(k,h,j,unescape(i),l)!==false){a("#"+a(this).attr("id")+h+" .percentage").text(" - Completed");a("#"+a(this).attr("id")+h).fadeOut(250,function(){a(this).remove()})}});if(typeof(settings.onAllComplete)=="function"){a(this).bind("uploadifyAllComplete",{action:settings.onAllComplete},function(h,i){if(h.data.action(h,i)!==false){c=[]}})}})},uploadifySettings:function(f,j,c){var g=false;a(this).each(function(){if(f=="scriptData"&&j!=null){if(c){var i=j}else{var i=a.extend(settings.scriptData,j)}var l="";for(var k in i){l+="&"+k+"="+escape(i[k])}j=l.substr(1)}g=document.getElementById(a(this).attr("id")+"Uploader").updateSettings(f,j)});if(j==null){if(f=="scriptData"){var b=unescape(g).split("&");var e=new Object();for(var d=0;d<b.length;d++){var h=b[d].split("=");e[h[0]]=h[1]}g=e}return g}},uploadifyUpload:function(b){a(this).each(function(){document.getElementById(a(this).attr("id")+"Uploader").startFileUpload(b,false)})},uploadifyCancel:function(b){a(this).each(function(){document.getElementById(a(this).attr("id")+"Uploader").cancelFileUpload(b,true,false)})},uploadifyClearQueue:function(){a(this).each(function(){document.getElementById(a(this).attr("id")+"Uploader").clearFileUploadQueue(false)})}})})(jQuery)};"use strict";var Lib={CARD_ACTION_CLASSES_BLACKLIST_:["linkLeft","linkRight","dataLink","headerCardAction","headerCardActionInMenu","headerCardActionInMenuOnly",],overlayEl_:document.getElementById("overlay"),modalContainerEl_:document.getElementById("modalContainer"),desktopMenuEl_:document.getElementById("catMenu"),mobileMenuEl_:document.getElementById("mobileMenu"),modalContainerEl_:document.getElementsByClassName("modalContent")[0],modalListeners_:{},uuid:function(){function a(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},getAncestor:function(b,a){var c=HTMLElement.prototype.matches||HTMLElement.prototype.webkitMatchesSelector||HTMLElement.prototype.mozMatchesSelector||HTMLElement.prototype.msMatchesSelector;if(c.call(b,"."+a)){return b}if(!b.parentElement){return null}return this.getAncestor(b.parentElement,a)},onHeaderCardMenuClick:function(c){var b=this.getAncestor(c.target,"cardWrapper");var h=b.getElementsByClassName("headerCardActionInMenu");var j=[];for(var f=0,e=h.length;f<e;f++){var n=this.getActionList(h[f]);j=j.concat(n)}var k=document.createElement("ul");k.classList.add("modalList");for(var f=0,e=j.length;f<e;f++){var p=document.createElement("li");var o=document.createElement("a");o.setAttribute("href",j[f].href);o.setAttribute("class",j[f].className);var q=document.createTextNode(j[f].label);o.appendChild(q);p.appendChild(o);k.appendChild(p)}var g="actionMenu";var d=this.getModalContentEl(g);d.innerHTML="";d.appendChild(k);this.showModal(g)},maybeGetAttributesFromElement:function(b){var c=[];if(!b.hasAttribute("href")||b.hasAttribute("aria-hidden")){return c}var a;if(b.hasAttribute("aria-label")){a=b.getAttribute("aria-label")}else{if(b.hasAttribute("title")){a=b.getAttribute("title")}else{a=b.innerText}}if(a.length==0){return c}c.push({href:b.getAttribute("href"),label:a,className:b.className.split(" ").filter(function(d){return this.CARD_ACTION_CLASSES_BLACKLIST_.indexOf(d)==-1},this).join(" ")});return c},getActionList:function(d){if(d.tagName=="A"){return this.maybeGetAttributesFromElement(d)}else{var e=[];var b=d.getElementsByTagName("a");for(var c=0,a=b.length;c<a;c++){e=e.concat(this.maybeGetAttributesFromElement(b[c]))}return e}},getModalContentEl:function(a){return document.getElementById("modalContent-"+a)},showOverlay:function(){this.overlayEl_.classList.add("visible")},hideOverlay:function(){this.overlayEl_.classList.remove("visible")},setupMenus:function(b){var a=document.getElementById("menuButton");a.addEventListener("click",this.showMobileMenu.bind(this));this.overlayEl_.addEventListener("click",(function(c){if(c.target==this.overlayEl_){this.dismissMobileMenu();this.dismissModal()}}).bind(this));document.body.addEventListener("keyup",this.onModalKeyPress.bind(this),true);$("#searchButton").bind("click",function(c){document.body.classList.toggle("searchVisible");if(document.body.classList.contains("searchVisible")){$("#searchTerms").focus()}});Lib.Event.listenOnClass("click","category",this.onCategoryClick,this);this.desktopMenuEl_.addEventListener("mouseleave",this.closeMenuDropdowns.bind(this))},onCategoryClick:function(b){this.closeMenuDropdowns();var a=b.target.parentElement;if(a.classList.contains("activeCat")){return}else{if(a.classList.contains("inactiveCat")){b.preventDefault();a.getElementsByTagName("ul")[0].classList.toggle("visible")}}},closeMenuDropdowns:function(f){var b=this.desktopMenuEl_.getElementsByClassName("inactiveCat");for(var c=0,a=b.length;c<a;c++){var d=b[c].getElementsByTagName("ul");if(d&&d[0]){d[0].classList.remove("visible")}}},showMobileMenu:function(){this.showOverlay();setTimeout((function(){this.mobileMenuEl_.classList.add("visible")}).bind(this),0)},dismissMobileMenu:function(){this.mobileMenuEl_.classList.remove("visible");setTimeout((function(){this.hideOverlay()}).bind(this),10000)},showModal:function(a){this.modalListeners_.closeClick=Lib.Event.listenOnClass("click","closeModal",this.dismissModal,this);if(a){this.showModalContainer_();this.hideModalContentChildren_(this.getModalContentEl(a))}this.showOverlay()},dismissModal:function(){this.hideOverlay();this.hideModalContainer_();this.hideModalContentChildren_();this.overlayEl_.removeEventListener("click",this.dismissModal);Lib.Event.unlistenByKey(this.modalListeners_.closeClick);delete this.modalListeners_.closeClick;document.removeEventListener("keyup",this.onModalKeyPress)},showModalContainer_:function(){this.modalContainerEl_.classList.add("visible")},hideModalContainer_:function(){this.modalContainerEl_.classList.remove("visible")},hideModalContentChildren_:function(d){var b=this.overlayEl_.getElementsByClassName("modalContentItem");for(var c=0,a=b.length;c<a;c++){if(d&&b[c]===d){b[c].classList.add("visible")}else{b[c].classList.remove("visible")}}},onModalKeyPress:function(a){if(a.keyCode==27){this.dismissModal()}},setupPageScrollListener:function(){var g;var c;var e=0;var d="down";var a="visible";var b;var j=document.getElementById("header");var i=20;var h=667;function f(l){var k=window.scrollY;if(k<e){c="up"}else{c="down"}if(c!=d){if(c=="up"){b="visible"}else{if(k>i){b="hidden"}}}else{if(c=="down"&&k>i){b="hidden"}}e=k;d=c;j.classList.toggle("offscreen",b=="hidden")}window.addEventListener("scroll",function(k){if(window.innerWidth>h){j.classList.remove("offscreen");return}if(g){return}g=setTimeout(function(){f(k);g=null},200)})}};var Lib=Lib||{};Lib.Event={globalListeners_:{},delegatedListenerKeys_:{},delegatedListeners_:{},listenOnClass:function(a,c,d,b){if(!this.delegatedListeners_[a]){this.delegatedListeners_[a]={};document.body.addEventListener(a,this.globalListener_.bind(this),true)}if(!this.delegatedListeners_[a][c]){this.delegatedListeners_[a][c]=[]}eventKey=Lib.uuid();this.delegatedListeners_[a][c].push(eventKey);if(b){d=d.bind(b)}this.delegatedListenerKeys_[eventKey]=d;return eventKey},unlistenByKey:function(b){loop:for(var a in this.delegatedListeners_){for(var c in this.delegatedListeners_[a]){if(this.delegatedListeners_[a][c]==b){delete this.delegatedListeners_[a][c];if(Object.keys(this.delegatedListeners_[a]).length==0){delete this.delegatedListeners_[a]}break loop}}}delete this.delegatedListenerKeys_[b]},unlistenByClass:function(c){var b;loop:for(var a in this.delegatedListeners_){for(var d in this.delegatedListeners_[a]){if(d==c){b=this.delegatedListeners_[a][d];delete this.delegatedListeners_[a][d];if(Object.keys(this.delegatedListeners_[a]).length==0){delete this.delegatedListeners_[a]}break loop}}}delete this.delegatedListenerKeys_[b]},globalListener_:function(d){if(!this.delegatedListeners_[d.type]){return}for(className in this.delegatedListeners_[d.type]){var c=Lib.getAncestor(d.target,className);if(!c){continue}var e=this.delegatedListeners_[d.type][className];for(var b=0,a=e.length;b<a;b++){cb=this.delegatedListenerKeys_[e[b]];if(cb){cb(d)}}}}};var Lib=Lib||{};Lib.Form={ucfirst:function(b){b+="";var a=b.charAt(0).toUpperCase();return a+b.substr(1)},submitHandler:function(d){if(typeof(tinyMCE)!="undefined"){tinyMCE.triggerSave()}var j=d.elements;var a=true;if(typeof this.Forms=="undefined"){return a}var n=(d.id)?d.id:"form";var m=this.Forms[n];for(var l in m){var g=d[l];var k=m[l];var b=true;var o=[];for(var f in k){var e=k[f].name;if(typeof(this.validators[e])=="undefined"){continue}var h=this.validators[e](g,k[f].parameters,k[f].messages);if(h&&h.length!=0){b=false;o.push(h);if(k[f].breakChainOnFailure){break}}}if(g.disabled){b=true;o=[]}this.updateError(g,b,o);if(!b){a=false}}return a},updateError:function(b,a,d){if(a){$("#"+b.id+"Error").html("").css("display","none")}else{var c=this.ucfirst(d.join(", "));$("#"+b.id+"Error").css("display","none").html(c).fadeIn("def")}},validators:{id0:function(b,d,c){if(d.allowWhiteSpace){var a=b.value.match(/^[a-z0-9\s]*$/i)}else{var a=b.value.match(/^[a-z0-9]*$/i)}return(a)?"":c.notAlnum},id1:function(b,d,c){if(d.allowWhiteSpace){var a=b.value.match(/^[a-z\s]*$/i)}else{var a=b.value.match(/^[a-z]*$/i)}return(a)?"":c.notAlpha},id2:function(a,c,b){var d="";if(c.inclusive){if(a.value<c.max&&a.value>c.min){return""}d=b.notBetweenStrict}else{if(a.value<=c.max&&a.value>=c.min){return""}d=b.notBetween}d=d.replace("%value%",a.value);d=d.replace("%min%",c.min);d=d.replace("%max%",c.max);return d},id3:function(b,d,c){if(b.value.length==0){return""}var a=b.value.match(d.regex);return(a)?"":c.dateInvalid},id4:function(b,d,c){var a=b.value.match(/^[0-9]*$/i);return(a)?"":c.notDigits},id5:function(c,e,d){var a=new RegExp(/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.([a-z]){2,4})$/i);var b=a.exec(c.value);return(b)?"":d.emailAddressInvalid},id6:function(b,d,c){var a=(b.value==parseFloat(b.value));return(a)?"":c.notFloat},id7:function(b,d,c){var a=(b.value>d.min);return(a)?"":c.notGreaterThan},id8:function(a,c,b){return""},id9:function(a,c,b){return""},id10:function(b,d,c){if(!b.value){return""}for(var a=0;a<d.haystack.length;a++){if(b.value==d.haystack[a]){return""}}return c.notInArray},id11:function(b,d,c){if(b.value.length==0){return""}var a=(b.value==parseInt(b.value)&&b.value==parseFloat(b.value));return(a)?"":c.notInt},id12:function(b,d,c){var a=(b.value<d.max);return(a)?"":c.notLesserThan},id13:function(b,d,c){var a=(b.value.length>0);return(a)?"":c.isEmpty},id14:function(c,e,d){var a=new RegExp(e.regex);var b=a.exec(c.value);return(b)?"":d.regexNotMatch},id15:function(a,c,b){if(a.value.length>c.max){return b.stringLengthTooLong}if(a.value.length<c.min){return b.stringLengthTooShort}return""},id16:function(b,d,c){var e=$("#"+d.reference).get(0).value;var a=(b.value==e);return(a)?"":c.notSame},id17:function(a,c,b){return""},id18:function(a,c,b){return""},id20:function(a,c,b){if(a.value.length==0||a.value=="0"){return b.locationRequired}return""}},ajaxValidationHandler:function(a,b,d,c){if(typeof(this.ajaxValidators[b])=="undefined"){return}this.ajaxValidators[b](a,d,c)},ajaxValidators:{id0:function(a,b,d){var c={};c[a.id]=a.value;$.get(d.route,c,function(g,e){var f=[];for(var h in g.messageNames){f.push(b[g.messageNames[h]])}Lib.Form.updateError(a,g.status,f)},"json")},id1:function(a,b,d){var c={};c[a.id]=a.value;c.userId=d.userId;$.get(d.route,c,function(g,e){var f=[];for(var h in g.messageNames){f.push(b[g.messageNames[h]])}Lib.Form.updateError(a,g.status,f)},"json")},id2:function(a,b,d){var c={};c[a.id]=a.value;c.userId=d.userId;$.get(d.route,c,function(g,e){var f=[];for(var h in g.messageNames){f.push(b[g.messageNames[h]])}Lib.Form.updateError(a,g.status,f)},"json")},id3:function(b,c,e){var d={};d[b.id]=b.value;var a=function(){$.get(e.route,d,function(h,f){var g=[];for(var i in h.messageNames){g.push(c[h.messageNames[i]])}Lib.Form.updateError(b,h.status,g)},"json")};setTimeout("deferredCheck",1000)}}};(function(a){a.fn.extend({autocomplete:function(b,c){var d=typeof b=="string";c=a.extend({},a.Autocompleter.defaults,{url:d?b:null,data:d?null:b,delay:d?a.Autocompleter.defaults.delay:10,max:c&&!c.scroll?10:150},c);c.highlight=c.highlight||function(e){return e};c.formatMatch=c.formatMatch||c.formatItem;return this.each(function(){new a.Autocompleter(this,c)})},result:function(b){return this.bind("result",b)},search:function(b){return this.trigger("search",[b])},flushCache:function(){return this.trigger("flushCache")},setOptions:function(b){return this.trigger("setOptions",[b])},unautocomplete:function(){return this.trigger("unautocomplete")}});a.Autocompleter=function(l,g){var c={UP:38,DOWN:40,DEL:46,TAB:9,RETURN:13,ESC:27,COMMA:188,PAGEUP:33,PAGEDOWN:34,BACKSPACE:8};var b=a(l).attr("autocomplete","off").addClass(g.inputClass);var j;var p="";var m=a.Autocompleter.Cache(g);var e=0;var u;var x={mouseDownOnSelect:false};var r=a.Autocompleter.Select(g,l,d,x);var w;a.browser.opera&&a(l.form).bind("submit.autocomplete",function(){if(w){w=false;return false}});b.bind((a.browser.opera?"keypress":"keydown")+".autocomplete",function(y){u=y.keyCode;switch(y.keyCode){case c.UP:y.preventDefault();if(r.visible()){r.prev()}else{t(0,true)}break;case c.DOWN:y.preventDefault();if(r.visible()){r.next()}else{t(0,true)}break;case c.PAGEUP:y.preventDefault();if(r.visible()){r.pageUp()}else{t(0,true)}break;case c.PAGEDOWN:y.preventDefault();if(r.visible()){r.pageDown()}else{t(0,true)}break;case g.multiple&&a.trim(g.multipleSeparator)==","&&c.COMMA:case c.TAB:case c.RETURN:if(d()){y.preventDefault();w=true;return false}break;case c.ESC:r.hide();break;default:clearTimeout(j);j=setTimeout(t,g.delay);break}}).focus(function(){e++}).blur(function(){e=0;if(!x.mouseDownOnSelect){s()}}).click(function(){if(e++>1&&!r.visible()){t(0,true)}}).bind("search",function(){var y=(arguments.length>1)?arguments[1]:null;function z(D,C){var A;if(C&&C.length){for(var B=0;B<C.length;B++){if(C[B].result.toLowerCase()==D.toLowerCase()){A=C[B];break}}}if(typeof y=="function"){y(A)}else{b.trigger("result",A&&[A.data,A.value])}}a.each(h(b.val()),function(A,B){f(B,z,z)})}).bind("flushCache",function(){m.flush()}).bind("setOptions",function(){a.extend(g,arguments[1]);if("data" in arguments[1]){m.populate()}}).bind("unautocomplete",function(){r.unbind();b.unbind();a(l.form).unbind(".autocomplete")});function d(){var z=r.selected();if(!z){return false}var y=z.result;p=y;if(g.multiple){var A=h(b.val());if(A.length>1){y=A.slice(0,A.length-1).join(g.multipleSeparator)+g.multipleSeparator+y}y+=g.multipleSeparator}b.val(y);v();b.trigger("result",[z.data,z.value]);return true}function t(A,z){if(u==c.DEL){r.hide();return}var y=b.val();if(!z&&y==p){return}p=y;y=i(y);if(y.length>=g.minChars){b.addClass(g.loadingClass);if(!g.matchCase){y=y.toLowerCase()}f(y,k,v)}else{n();r.hide()}}function h(z){if(!z){return[""]}var A=z.split(g.multipleSeparator);var y=[];a.each(A,function(B,C){if(a.trim(C)){y[B]=a.trim(C)}});return y}function i(y){if(!g.multiple){return y}var z=h(y);return z[z.length-1]}function q(y,z){if(g.autoFill&&(i(b.val()).toLowerCase()==y.toLowerCase())&&u!=c.BACKSPACE){b.val(b.val()+z.substring(i(p).length));a.Autocompleter.Selection(l,p.length,p.length+z.length)}}function s(){clearTimeout(j);j=setTimeout(v,200)}function v(){var y=r.visible();r.hide();clearTimeout(j);n();if(g.mustMatch){b.search(function(z){if(!z){if(g.multiple){var A=h(b.val()).slice(0,-1);b.val(A.join(g.multipleSeparator)+(A.length?g.multipleSeparator:""))}else{b.val("")}}})}if(y){a.Autocompleter.Selection(l,l.value.length,l.value.length)}}function k(z,y){if(y&&y.length&&e){n();r.display(y,z);q(z,y[0].value);r.show()}else{v()}}function f(z,B,y){if(!g.matchCase){z=z.toLowerCase()}var A=m.load(z);if(A&&A.length){B(z,A)}else{if((typeof g.url=="string")&&(g.url.length>0)){var C={timestamp:+new Date()};a.each(g.extraParams,function(D,E){C[D]=typeof E=="function"?E():E});a.ajax({mode:"abort",port:"autocomplete"+l.name,dataType:g.dataType,url:g.url,data:a.extend({q:i(z),limit:g.max},C),success:function(E){var D=g.parse&&g.parse(E)||o(E);m.add(z,D);B(z,D)}})}else{r.emptyList();y(z)}}}function o(B){var y=[];var A=B.split("\n");for(var z=0;z<A.length;z++){var C=a.trim(A[z]);if(C){C=C.split("|");y[y.length]={data:C,value:C[0],result:g.formatResult&&g.formatResult(C,C[0])||C[0]}}}return y}function n(){b.removeClass(g.loadingClass)}};a.Autocompleter.defaults={inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",minChars:1,delay:400,matchCase:false,matchSubset:true,matchContains:false,cacheLength:10,max:100,mustMatch:false,extraParams:{},selectFirst:true,formatItem:function(b){return b[0]},formatMatch:null,autoFill:false,width:0,multiple:false,multipleSeparator:", ",highlight:function(c,b){return c.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+b.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>")},scroll:true,scrollHeight:180,filter:function(b){return b}};a.Autocompleter.Cache=function(c){var f={};var d=0;function h(l,k){if(!c.matchCase){l=l.toLowerCase()}var j=l.indexOf(k);if(j==-1){return false}return j==0||c.matchContains}function g(j,i){if(d>c.cacheLength){b()}if(!f[j]){d++}f[j]=i}function e(){if(!c.data){return false}var k={},j=0;if(!c.url){c.cacheLength=1}k[""]=[];for(var m=0,l=c.data.length;m<l;m++){var p=c.data[m];p=(typeof p=="string")?[p]:p;var o=c.formatMatch(p,m+1,c.data.length);if(o===false){continue}var n=o.charAt(0).toLowerCase();if(!k[n]){k[n]=[]}var q={value:o,data:p,result:c.formatResult&&c.formatResult(p)||o};k[n].push(q);if(j++<c.max){k[""].push(q)}}a.each(k,function(r,s){c.cacheLength++;g(r,s)})}setTimeout(e,25);function b(){f={};d=0}return{flush:b,add:g,populate:e,load:function(n){if(!c.cacheLength||!d){return null}if(!c.url&&c.matchContains){var m=[];for(var j in f){if(j.length>0){var o=f[j];a.each(o,function(p,k){if(h(k.value,n)){m.push(k)}})}}return m}else{if(f[n]){return f[n]}else{if(c.matchSubset){for(var l=n.length-1;l>=c.minChars;l--){var o=f[n.substr(0,l)];if(o){var m=[];a.each(o,function(p,k){if(h(k.value,n)){m[m.length]=k}});return m}}}}}return null}}};a.Autocompleter.Select=function(e,j,l,p){var i={ACTIVE:"ac_over"};var k,f=-1,r,m="",s=true,c,o;function n(){if(!s){return}c=a("<div/>").hide().addClass(e.resultsClass).css("position","absolute").appendTo(document.body);o=a("<ul/>").appendTo(c).mouseover(function(t){if(q(t).nodeName&&q(t).nodeName.toUpperCase()=="LI"){f=a("li",o).removeClass(i.ACTIVE).index(q(t));a(q(t)).addClass(i.ACTIVE)}}).click(function(t){a(q(t)).addClass(i.ACTIVE);l();j.focus();return false}).mousedown(function(){p.mouseDownOnSelect=true}).mouseup(function(){p.mouseDownOnSelect=false});if(e.width>0){c.css("width",e.width)}s=false}function q(u){var t=u.target;while(t&&t.tagName!="LI"){t=t.parentNode}if(!t){return[]}return t}function h(t){k.slice(f,f+1).removeClass(i.ACTIVE);g(t);var v=k.slice(f,f+1).addClass(i.ACTIVE);if(e.scroll){var u=0;k.slice(0,f).each(function(){u+=this.offsetHeight});if((u+v[0].offsetHeight-o.scrollTop())>o[0].clientHeight){o.scrollTop(u+v[0].offsetHeight-o.innerHeight())}else{if(u<o.scrollTop()){o.scrollTop(u)}}}}function g(t){f+=t;if(f<0){f=k.size()-1}else{if(f>=k.size()){f=0}}}function b(t){return e.max&&e.max<t?e.max:t}function d(){o.empty();var u=b(r.length);for(var v=0;v<u;v++){if(!r[v]){continue}var w=e.formatItem(r[v].data,v+1,u,r[v].value,m);if(w===false){continue}var t=a("<li/>").html(e.highlight(w,m)).addClass(v%2==0?"ac_even":"ac_odd").appendTo(o)[0];a.data(t,"ac_data",r[v])}k=o.find("li");if(e.selectFirst){k.slice(0,1).addClass(i.ACTIVE);f=0}if(a.fn.bgiframe){o.bgiframe()}}return{display:function(u,t){n();r=e.filter.call(j,u,e);m=t;d()},next:function(){h(1)},prev:function(){h(-1)},pageUp:function(){if(f!=0&&f-8<0){h(-f)}else{h(-8)}},pageDown:function(){if(f!=k.size()-1&&f+8>k.size()){h(k.size()-1-f)}else{h(8)}},hide:function(){c&&c.hide();k&&k.removeClass(i.ACTIVE);f=-1},visible:function(){return c&&c.is(":visible")},current:function(){return this.visible()&&(k.filter("."+i.ACTIVE)[0]||e.selectFirst&&k[0])},show:function(){var v=a(j).offset();c.css({width:typeof e.width=="string"||e.width>0?e.width:a(j).width(),top:v.top+j.offsetHeight,left:v.left}).show();if(e.scroll){o.scrollTop(0);o.css({maxHeight:e.scrollHeight,overflow:"auto"});if(a.browser.msie&&typeof document.body.style.maxHeight==="undefined"){var t=0;k.each(function(){t+=this.offsetHeight});var u=t>e.scrollHeight;o.css("height",u?e.scrollHeight:t);if(!u){k.width(o.width()-parseInt(k.css("padding-left"))-parseInt(k.css("padding-right")))}}}},selected:function(){var t=k&&k.filter("."+i.ACTIVE).removeClass(i.ACTIVE);return t&&t.length&&a.data(t[0],"ac_data")},emptyList:function(){o&&o.empty()},unbind:function(){c&&c.remove()}}};a.Autocompleter.Selection=function(d,e,c){if(d.createTextRange){var b=d.createTextRange();b.collapse(true);b.moveStart("character",e);b.moveEnd("character",c);b.select()}else{if(d.setSelectionRange){d.setSelectionRange(e,c)}else{if(d.selectionStart){d.selectionStart=e;d.selectionEnd=c}}}d.focus()}})(jQuery);(function($){$.extend({tablesorter:new function(){var parsers=[],widgets=[];this.defaults={cssHeader:"header",cssAsc:"headerSortUp",cssDesc:"headerSortDown",cssChildRow:"expand-child",sortInitialOrder:"asc",sortMultiSortKey:"shiftKey",sortForce:null,sortAppend:null,sortLocaleCompare:true,textExtraction:"simple",parsers:{},widgets:[],widgetZebra:{css:["even","odd"]},headers:{},widthFixed:false,cancelSelection:true,sortList:[],headerList:[],dateFormat:"us",decimal:"/.|,/g",onRenderHeader:null,selectorHeaders:"thead th",debug:false};function benchmark(s,d){log(s+","+(new Date().getTime()-d.getTime())+"ms")}this.benchmark=benchmark;function log(s){if(typeof console!="undefined"&&typeof console.debug!="undefined"){console.log(s)}else{alert(s)}}function buildParserCache(table,$headers){if(table.config.debug){var parsersDebug=""}if(table.tBodies.length==0){return}var rows=table.tBodies[0].rows;if(rows[0]){var list=[],cells=rows[0].cells,l=cells.length;for(var i=0;i<l;i++){var p=false;if($.metadata&&($($headers[i]).metadata()&&$($headers[i]).metadata().sorter)){p=getParserById($($headers[i]).metadata().sorter)}else{if((table.config.headers[i]&&table.config.headers[i].sorter)){p=getParserById(table.config.headers[i].sorter)}}if(!p){p=detectParserForColumn(table,rows,-1,i)}if(table.config.debug){parsersDebug+="column:"+i+" parser:"+p.id+"\n"}list.push(p)}}if(table.config.debug){log(parsersDebug)}return list}function detectParserForColumn(table,rows,rowIndex,cellIndex){var l=parsers.length,node=false,nodeValue=false,keepLooking=true;while(nodeValue==""&&keepLooking){rowIndex++;if(rows[rowIndex]){node=getNodeFromRowAndCellIndex(rows,rowIndex,cellIndex);nodeValue=trimAndGetNodeText(table.config,node);if(table.config.debug){log("Checking if value was empty on row:"+rowIndex)}}else{keepLooking=false}}for(var i=1;i<l;i++){if(parsers[i].is(nodeValue,table,node)){return parsers[i]}}return parsers[0]}function getNodeFromRowAndCellIndex(rows,rowIndex,cellIndex){return rows[rowIndex].cells[cellIndex]}function trimAndGetNodeText(config,node){return $.trim(getElementText(config,node))}function getParserById(name){var l=parsers.length;for(var i=0;i<l;i++){if(parsers[i].id.toLowerCase()==name.toLowerCase()){return parsers[i]}}return false}function buildCache(table){if(table.config.debug){var cacheTime=new Date()}var totalRows=(table.tBodies[0]&&table.tBodies[0].rows.length)||0,totalCells=(table.tBodies[0].rows[0]&&table.tBodies[0].rows[0].cells.length)||0,parsers=table.config.parsers,cache={row:[],normalized:[]};for(var i=0;i<totalRows;++i){var c=$(table.tBodies[0].rows[i]),cols=[];if(c.hasClass(table.config.cssChildRow)){cache.row[cache.row.length-1]=cache.row[cache.row.length-1].add(c);continue}cache.row.push(c);for(var j=0;j<totalCells;++j){cols.push(parsers[j].format(getElementText(table.config,c[0].cells[j]),table,c[0].cells[j]))}cols.push(cache.normalized.length);cache.normalized.push(cols);cols=null}if(table.config.debug){benchmark("Building cache for "+totalRows+" rows:",cacheTime)}return cache}function getElementText(config,node){var text="";if(!node){return""}if(!config.supportsTextContent){config.supportsTextContent=node.textContent||false}if(config.textExtraction=="simple"){if(config.supportsTextContent){text=node.textContent}else{if(node.childNodes[0]&&node.childNodes[0].hasChildNodes()){text=node.childNodes[0].innerHTML}else{text=node.innerHTML}}}else{if(typeof(config.textExtraction)=="function"){text=config.textExtraction(node)}else{text=$(node).text()}}return text}function appendToTable(table,cache){if(table.config.debug){var appendTime=new Date()}var c=cache,r=c.row,n=c.normalized,totalRows=n.length,checkCell=(n[0].length-1),tableBody=$(table.tBodies[0]),rows=[];for(var i=0;i<totalRows;i++){var pos=n[i][checkCell];rows.push(r[pos]);if(!table.config.appender){var l=r[pos].length;for(var j=0;j<l;j++){tableBody[0].appendChild(r[pos][j])}}}if(table.config.appender){table.config.appender(table,rows)}rows=null;if(table.config.debug){benchmark("Rebuilt table:",appendTime)}applyWidget(table);setTimeout(function(){$(table).trigger("sortEnd")},0)}function buildHeaders(table){if(table.config.debug){var time=new Date()}var meta=($.metadata)?true:false;var header_index=computeTableHeaderCellIndexes(table);$tableHeaders=$(table.config.selectorHeaders,table).each(function(index){this.column=header_index[this.parentNode.rowIndex+"-"+this.cellIndex];this.order=formatSortingOrder(table.config.sortInitialOrder);this.count=this.order;if(checkHeaderMetadata(this)||checkHeaderOptions(table,index)){this.sortDisabled=true}if(checkHeaderOptionsSortingLocked(table,index)){this.order=this.lockedOrder=checkHeaderOptionsSortingLocked(table,index)}if(!this.sortDisabled){var $th=$(this).addClass(table.config.cssHeader);if(table.config.onRenderHeader){table.config.onRenderHeader.apply($th)}}table.config.headerList[index]=this});if(table.config.debug){benchmark("Built headers:",time);log($tableHeaders)}return $tableHeaders}function computeTableHeaderCellIndexes(t){var matrix=[];var lookup={};var thead=t.getElementsByTagName("THEAD")[0];var trs=thead.getElementsByTagName("TR");for(var i=0;i<trs.length;i++){var cells=trs[i].cells;for(var j=0;j<cells.length;j++){var c=cells[j];var rowIndex=c.parentNode.rowIndex;var cellId=rowIndex+"-"+c.cellIndex;var rowSpan=c.rowSpan||1;var colSpan=c.colSpan||1;var firstAvailCol;if(typeof(matrix[rowIndex])=="undefined"){matrix[rowIndex]=[]}for(var k=0;k<matrix[rowIndex].length+1;k++){if(typeof(matrix[rowIndex][k])=="undefined"){firstAvailCol=k;break}}lookup[cellId]=firstAvailCol;for(var k=rowIndex;k<rowIndex+rowSpan;k++){if(typeof(matrix[k])=="undefined"){matrix[k]=[]}var matrixrow=matrix[k];for(var l=firstAvailCol;l<firstAvailCol+colSpan;l++){matrixrow[l]="x"}}}}return lookup}function checkCellColSpan(table,rows,row){var arr=[],r=table.tHead.rows,c=r[row].cells;for(var i=0;i<c.length;i++){var cell=c[i];if(cell.colSpan>1){arr=arr.concat(checkCellColSpan(table,headerArr,row++))}else{if(table.tHead.length==1||(cell.rowSpan>1||!r[row+1])){arr.push(cell)}}}return arr}function checkHeaderMetadata(cell){if(($.metadata)&&($(cell).metadata().sorter===false)){return true}return false}function checkHeaderOptions(table,i){if((table.config.headers[i])&&(table.config.headers[i].sorter===false)){return true}return false}function checkHeaderOptionsSortingLocked(table,i){if((table.config.headers[i])&&(table.config.headers[i].lockedOrder)){return table.config.headers[i].lockedOrder}return false}function applyWidget(table){var c=table.config.widgets;var l=c.length;for(var i=0;i<l;i++){getWidgetById(c[i]).format(table)}}function getWidgetById(name){var l=widgets.length;for(var i=0;i<l;i++){if(widgets[i].id.toLowerCase()==name.toLowerCase()){return widgets[i]}}}function formatSortingOrder(v){if(typeof(v)!="Number"){return(v.toLowerCase()=="desc")?1:0}else{return(v==1)?1:0}}function isValueInArray(v,a){var l=a.length;for(var i=0;i<l;i++){if(a[i][0]==v){return true}}return false}function setHeadersCss(table,$headers,list,css){$headers.removeClass(css[0]).removeClass(css[1]);var h=[];$headers.each(function(offset){if(!this.sortDisabled){h[this.column]=$(this)}});var l=list.length;for(var i=0;i<l;i++){h[list[i][0]].addClass(css[list[i][1]])}}function fixColumnWidth(table,$headers){var c=table.config;if(c.widthFixed){var colgroup=$("<colgroup>");$("tr:first td",table.tBodies[0]).each(function(){colgroup.append($("<col>").css("width",$(this).width()))});$(table).prepend(colgroup)}}function updateHeaderSortCount(table,sortList){var c=table.config,l=sortList.length;for(var i=0;i<l;i++){var s=sortList[i],o=c.headerList[s[0]];o.count=s[1];o.count++}}function multisort(table,sortList,cache){if(table.config.debug){var sortTime=new Date()}var dynamicExp="var sortWrapper = function(a,b) {",l=sortList.length;for(var i=0;i<l;i++){var c=sortList[i][0];var order=sortList[i][1];var s=(table.config.parsers[c].type=="text")?((order==0)?makeSortFunction("text","asc",c):makeSortFunction("text","desc",c)):((order==0)?makeSortFunction("numeric","asc",c):makeSortFunction("numeric","desc",c));var e="e"+i;dynamicExp+="var "+e+" = "+s;dynamicExp+="if("+e+") { return "+e+"; } ";dynamicExp+="else { "}var orgOrderCol=cache.normalized[0].length-1;dynamicExp+="return a["+orgOrderCol+"]-b["+orgOrderCol+"];";for(var i=0;i<l;i++){dynamicExp+="}; "}dynamicExp+="return 0; ";dynamicExp+="}; ";if(table.config.debug){benchmark("Evaling expression:"+dynamicExp,new Date())}eval(dynamicExp);cache.normalized.sort(sortWrapper);if(table.config.debug){benchmark("Sorting on "+sortList.toString()+" and dir "+order+" time:",sortTime)}return cache}function makeSortFunction(type,direction,index){var a="a["+index+"]",b="b["+index+"]";if(type=="text"&&direction=="asc"){return"("+a+" == "+b+" ? 0 : ("+a+" === null ? Number.POSITIVE_INFINITY : ("+b+" === null ? Number.NEGATIVE_INFINITY : ("+a+" < "+b+") ? -1 : 1 )));"}else{if(type=="text"&&direction=="desc"){return"("+a+" == "+b+" ? 0 : ("+a+" === null ? Number.POSITIVE_INFINITY : ("+b+" === null ? Number.NEGATIVE_INFINITY : ("+b+" < "+a+") ? -1 : 1 )));"}else{if(type=="numeric"&&direction=="asc"){return"("+a+" === null && "+b+" === null) ? 0 :("+a+" === null ? Number.POSITIVE_INFINITY : ("+b+" === null ? Number.NEGATIVE_INFINITY : "+a+" - "+b+"));"}else{if(type=="numeric"&&direction=="desc"){return"("+a+" === null && "+b+" === null) ? 0 :("+a+" === null ? Number.POSITIVE_INFINITY : ("+b+" === null ? Number.NEGATIVE_INFINITY : "+b+" - "+a+"));"}}}}}function makeSortText(i){return"((a["+i+"] < b["+i+"]) ? -1 : ((a["+i+"] > b["+i+"]) ? 1 : 0));"}function makeSortTextDesc(i){return"((b["+i+"] < a["+i+"]) ? -1 : ((b["+i+"] > a["+i+"]) ? 1 : 0));"}function makeSortNumeric(i){return"a["+i+"]-b["+i+"];"}function makeSortNumericDesc(i){return"b["+i+"]-a["+i+"];"}function sortText(a,b){if(table.config.sortLocaleCompare){return a.localeCompare(b)}return((a<b)?-1:((a>b)?1:0))}function sortTextDesc(a,b){if(table.config.sortLocaleCompare){return b.localeCompare(a)}return((b<a)?-1:((b>a)?1:0))}function sortNumeric(a,b){return a-b}function sortNumericDesc(a,b){return b-a}function getCachedSortType(parsers,i){return parsers[i].type}this.construct=function(settings){return this.each(function(){if(!this.tHead||!this.tBodies){return}var $this,$document,$headers,cache,config,shiftDown=0,sortOrder;this.config={};config=$.extend(this.config,$.tablesorter.defaults,settings);$this=$(this);$.data(this,"tablesorter",config);$headers=buildHeaders(this);this.config.parsers=buildParserCache(this,$headers);cache=buildCache(this);var sortCSS=[config.cssDesc,config.cssAsc];fixColumnWidth(this);$headers.click(function(e){var totalRows=($this[0].tBodies[0]&&$this[0].tBodies[0].rows.length)||0;if(!this.sortDisabled&&totalRows>0){$this.trigger("sortStart");var $cell=$(this);var i=this.column;this.order=this.count++%2;if(this.lockedOrder){this.order=this.lockedOrder}if(!e[config.sortMultiSortKey]){config.sortList=[];if(config.sortForce!=null){var a=config.sortForce;for(var j=0;j<a.length;j++){if(a[j][0]!=i){config.sortList.push(a[j])}}}config.sortList.push([i,this.order])}else{if(isValueInArray(i,config.sortList)){for(var j=0;j<config.sortList.length;j++){var s=config.sortList[j],o=config.headerList[s[0]];if(s[0]==i){o.count=s[1];o.count++;s[1]=o.count%2}}}else{config.sortList.push([i,this.order])}}setTimeout(function(){setHeadersCss($this[0],$headers,config.sortList,sortCSS);appendToTable($this[0],multisort($this[0],config.sortList,cache))},1);return false}}).mousedown(function(){if(config.cancelSelection){this.onselectstart=function(){return false};return false}});$this.bind("update",function(){var me=this;setTimeout(function(){me.config.parsers=buildParserCache(me,$headers);cache=buildCache(me)},1)}).bind("updateCell",function(e,cell){var config=this.config;var pos=[(cell.parentNode.rowIndex-1),cell.cellIndex];cache.normalized[pos[0]][pos[1]]=config.parsers[pos[1]].format(getElementText(config,cell),cell)}).bind("sorton",function(e,list){$(this).trigger("sortStart");config.sortList=list;var sortList=config.sortList;updateHeaderSortCount(this,sortList);setHeadersCss(this,$headers,sortList,sortCSS);appendToTable(this,multisort(this,sortList,cache))}).bind("appendCache",function(){appendToTable(this,cache)}).bind("applyWidgetId",function(e,id){getWidgetById(id).format(this)}).bind("applyWidgets",function(){applyWidget(this)});if($.metadata&&($(this).metadata()&&$(this).metadata().sortlist)){config.sortList=$(this).metadata().sortlist}if(config.sortList.length>0){$this.trigger("sorton",[config.sortList])}applyWidget(this)})};this.addParser=function(parser){var l=parsers.length,a=true;for(var i=0;i<l;i++){if(parsers[i].id.toLowerCase()==parser.id.toLowerCase()){a=false}}if(a){parsers.push(parser)}};this.addWidget=function(widget){widgets.push(widget)};this.formatFloat=function(s){var i=parseFloat(s);return(isNaN(i))?0:i};this.formatInt=function(s){var i=parseInt(s);return(isNaN(i))?0:i};this.isDigit=function(s,config){return/^[-+]?\d*$/.test($.trim(s.replace(/[,.']/g,"")))};this.clearTableBody=function(table){if($.browser.msie){function empty(){while(this.firstChild){this.removeChild(this.firstChild)}}empty.apply(table.tBodies[0])}else{table.tBodies[0].innerHTML=""}}}});$.fn.extend({tablesorter:$.tablesorter.construct});var ts=$.tablesorter;ts.addParser({id:"text",is:function(s){return true},format:function(s){return $.trim(s.toLocaleLowerCase())},type:"text"});ts.addParser({id:"digit",is:function(s,table){var c=table.config;return $.tablesorter.isDigit(s,c)},format:function(s){return $.tablesorter.formatFloat(s)},type:"numeric"});ts.addParser({id:"currency",is:function(s){return/^[£$€?.]/.test(s)},format:function(s){return $.tablesorter.formatFloat(s.replace(new RegExp(/[£$€]/g),""))},type:"numeric"});ts.addParser({id:"ipAddress",is:function(s){return/^\d{2,3}[\.]\d{2,3}[\.]\d{2,3}[\.]\d{2,3}$/.test(s)},format:function(s){var a=s.split("."),r="",l=a.length;for(var i=0;i<l;i++){var item=a[i];if(item.length==2){r+="0"+item}else{r+=item}}return $.tablesorter.formatFloat(r)},type:"numeric"});ts.addParser({id:"url",is:function(s){return/^(https?|ftp|file):\/\/$/.test(s)},format:function(s){return jQuery.trim(s.replace(new RegExp(/(https?|ftp|file):\/\//),""))},type:"text"});ts.addParser({id:"isoDate",is:function(s){return/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(s)},format:function(s){return $.tablesorter.formatFloat((s!="")?new Date(s.replace(new RegExp(/-/g),"/")).getTime():"0")},type:"numeric"});ts.addParser({id:"percent",is:function(s){return/\%$/.test($.trim(s))},format:function(s){return $.tablesorter.formatFloat(s.replace(new RegExp(/%/g),""))},type:"numeric"});ts.addParser({id:"usLongDate",is:function(s){return s.match(new RegExp(/^[A-Za-z]{3,10}\.? [0-9]{1,2}, ([0-9]{4}|'?[0-9]{2}) (([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(AM|PM)))$/))},format:function(s){return $.tablesorter.formatFloat(new Date(s).getTime())},type:"numeric"});ts.addParser({id:"shortDate",is:function(s){return/\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}/.test(s)},format:function(s,table){var c=table.config;s=s.replace(/\-/g,"/");if(c.dateFormat=="us"){s=s.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$1/$2")}else{if(c.dateFormat=="uk"){s=s.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$2/$1")}else{if(c.dateFormat=="dd/mm/yy"||c.dateFormat=="dd-mm-yy"){s=s.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2})/,"$1/$2/$3")}}}return $.tablesorter.formatFloat(new Date(s).getTime())},type:"numeric"});ts.addParser({id:"time",is:function(s){return/^(([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(am|pm)))$/.test(s)},format:function(s){return $.tablesorter.formatFloat(new Date("2000/01/01 "+s).getTime())},type:"numeric"});ts.addParser({id:"metadata",is:function(s){return false},format:function(s,table,cell){var c=table.config,p=(!c.parserMetadataName)?"sortValue":c.parserMetadataName;return $(cell).metadata()[p]},type:"numeric"});ts.addWidget({id:"zebra",format:function(table){if(table.config.debug){var time=new Date()}var $tr,row=-1,odd;$("tr:visible",table.tBodies[0]).each(function(i){$tr=$(this);if(!$tr.hasClass(table.config.cssChildRow)){row++}odd=(row%2==0);$tr.removeClass(table.config.widgetZebra.css[odd?0:1]).addClass(table.config.widgetZebra.css[odd?1:0])});if(table.config.debug){$.tablesorter.benchmark("Applying Zebra widget",time)}}})})(jQuery);(function(j){j.tagbox={defaults:{separator:/[,]/,className:"tag",fx:true,container:"div",suggestion_links:null,dictionary_map:null,autocomplete:null,autocomplete_action:"selection"}};j.fn.extend({tagbox:function(v){var r=this;var u=[];this.each(function t(){var z=j(this);v=jQuery.extend({},j.tagbox.defaults,v);if(v.autocomplete){if(v.autocomplete.constructor==String||v.autocomplete.constructor==Array){v.autocomplete=k(v.autocomplete,v).sort()}else{if(v.autocomplete.constructor==Function){}else{}}}v.tag_class="."+v.className;var y=this;v.tag=j('<span class="'+v.className+'"><label><span></span><input type="text" name="'+v.name+'" value=" " /><small class="close" title="close">x</small></label></span>').get(0);p(v);if(z.is(":input")){var x=z;v.name=v.name||this.name;z.wrap("<"+v.container+' class="'+v.className+'"></'+v.container+">");z=z.parent().text(z.val());r.push(z.get(0));u.push(x.get(0));x.remove()}if(j.data(z.get(0),"settings")){return}j.data(z.get(0),"settings",v);z.click(function(A,B){j(this).tagboxNewTagAppend(B,v).find(v.tag_class+":last input").focus()}).bind("add_tag",function(A,B){j(this).trigger("click",B)}).bind("remove_tag",function(A,B){s.call(this,B).remove()}).bind("toggle_tag",function(A,B){suggestion=n(B,v);if(s.call(this,B).length){suggestion.removeClass("active");j(this).trigger("remove_tag",B)}else{suggestion.addClass("active");j(this).trigger("add_tag",B)}});if(j.trim(z.text())){var w=k(j.trim(z.text()),v);z.text("");j.each(w,function(){if(j.trim(this)){z.tagboxNewTagAppend(this,v)}});if(v.suggestion_links){j(v.suggestion_links).each(function(){link=j(this);if(j.inArray(link.text(),w)!==-1){link.addClass("active")}})}if(j.isFunction(v.init)){v.init.call(this,w)}}if(v.suggestion_links){j(v.suggestion_links).live("click",function(A){A.preventDefault();z.trigger("toggle_tag",j(this).text())})}});return r.filter(function(x){var w=true;for(var y=0;y<u.length;y++){if(u[y]==r.get(x)){w=false}}return w});function s(w){return j(this).find(v.tag_class+" input").filter(function(){return j(this).val()==w}).closest(v.tag_class)}function q(w,x){w.find("input").val(x).siblings("span").html(d(x));return w}},tagboxNewTagAppend:function(q,r){return a.call(this,q,r,"append")},tagboxNewTagBefore:function(q,r){return a.call(this,q,r,"before")},tagboxNewTagAfter:function(q,r){return a.call(this,q,r,"after")}});function a(q,r,s){var t=h(q,r);this[s](t);t.find("input").keyup();return this}function p(q){j(q.tag).click(q.click).click(g).find("input").focus(q.focus).blur(q.blur).keydown(q.keydown).keyup(q.keyup).focus(i).blur(e).keydown(m).keyup(l)}function o(r){var q,r=r instanceof jQuery?j(r).get(0):r,s=j.data(r,"settings");if(typeof s!="undefined"&&s.hasOwnProperty("separator")){q=s}else{q=o(r.parentNode)}return q}function c(u,s){var t="";if(u.charAt(u.length-1).match(s.separator)){t=u.charAt(u.length-1)}var q=new RegExp(s.grouping+".*?"+s.grouping,"g"),r;r=u.replace(q,"").replace(/(\s)\s/g,"$1").split(s.separator);q=u.match(q);u=j.map(j.merge(q,r),function(v){if(v){return j.trim(v)}});u.push(t);return u}function f(s,t,r){if(typeof s=="string"){var s=new RegExp("^"+s,"i")}if(j.isFunction(t)){t=k(t.call(),r)}var q=[];j.each(t,function(v,u){var w;if(r.dictionary_map){w=r.dictionary_map.call(this,u)}else{w=u}if(w.match(s)){q.push(u)}});return q}function b(y,t){var q=y.selectionStart,D=y.value.substr(0,q);var r=new RegExp("^"+D,"i");if(!y.selectionStart&&document.selection&&document.selection.createRange){var s=document.selection.createRange();s.moveStart("character",-y.value.length);q=s.text.length}var v=f(D,t.autocomplete,t);if(t.autocomplete_action=="selection"){if(v.length){var F;if(t.dictionary_map){F=t.dictionary_map(v[0])}else{F=v[0]}F=F.replace(r,"");if(D.substr(q+1,F.length+1)!=F){y.value=D.substr(0,q)+F+D.substr(q)}var C=q+F.length;if(y.setSelectionRange){y.setSelectionRange(q,C)}else{if(y.createTextRange){var x=y.createTextRange();x.collapse(true);x.moveStart("character",q);x.moveEnd("character",C);x.select()}}}}else{if(t.autocomplete_action=="list"){if(v.length){var B=j(y),A=B.offset(),z=B.closest(t.tag_class),u=j("#tagbox_autocomplete_sugestions"),E=false,w="<ul>";j.each(v,function(G,H){if(t.dictionary_map){F=t.dictionary_map(H)}else{F=H}w+="<li>"+F+"</li>"});w+="</ul>";if(u.size()===0){u=j('<div id="tagbox_autocomplete_sugestions"></div>');E=true}u.css({position:"absolute",zIndex:300,top:(A.top+B.outerHeight())+"px",left:A.left+"px"});u.html(w);if(E){u.insertAfter(z.get(0))}}else{j("#tagbox_autocomplete_sugestions").remove()}}else{if(j.isFunction(t.autocomplete_action)){t.autocomplete_action.call(this,v)}}}}function n(r,q){return j(q.suggestion_links).filter(function(){return j(this).text()==r})}function g(s){s.stopPropagation();settings=o(s.target);var r=j(s.target);if(r.is(".close")){if(settings.close){var q=settings.close.call(r,s,settings);if(typeof q==="boolean"){return q}}n(j(this).closest(settings.tag_class).find("input").val(),settings).removeClass("active");if(settings.fx){j(this).animate({width:"hide"},"fast",function(){j(this).remove()})}else{j(this).remove()}return false}if(r.is(settings.tag_class)){r.tagboxNewTagBefore(undefined,settings);r.prev(settings.tag_class).find(":input").focus()}}function i(q){this.initialValue=this.value;j(this).parent().parent().parent().parent().addClass("active")}function e(r){var q=o(r.target);j(this).parent().parent().parent().parent().removeClass("active");console.log(j(this));if(!j.trim(j(this).val())){setTimeout(function(){j(r.target).closest(q.tag_class).remove()},100)}else{if(q.suggestion_links){if(this.initialValue!=this.value){n(this.initialValue,q).removeClass("active")}n(this.value,q).addClass("active")}}}function m(s){if(s.keyCode==8){if(s.keyCode==13){s.preventDefault()}if(!j.trim(j(this).val())){var r=o(s.target),q=j(this).closest(r.tag_class),t=q.prev(r.tag_class);if(t.length){t.find(":input").focus();q.remove();s.preventDefault()}}}if(s.keyCode==9||s.keyCode==13){var r=o(s.target);if(!s.shiftKey&&j.trim(j(this).val())&&!j(this).closest(r.tag_class).next(r.tag_class).length){var q=j(this).closest(r.tag_class).tagboxNewTagAfter(undefined,r);setTimeout(function(){q.next(r.tag_class).find("input").focus()},50);return true}}}function l(w,q){var v=j(this),u=this.value,t=o(w.target);if(t.autocomplete&&u.length&&(q||String.fromCharCode(w.keyCode).match(/[a-z0-9@._-]/gim))){if(t.autocomplete.url){}b(this,t)}v.siblings("span").html(d(u));if((t.separator).test(u)){var r=k(u,t);if(!r){return}if(r.length===1){r.push("")}tag=v.closest(t.tag_class);v.val(r[0]).siblings("span").html(d(r[0]));var x=[];for(var s=r.length-1;s>0;s--){x.push(j(tag).tagboxNewTagAfter(r[s],t).next())}x.shift().find("input").focus();if(!j.trim(r[0])){tag.remove()}}}function k(t,s){if(!t||t.constructor!=String){return t}if(s.grouping&&t.indexOf(s.grouping)!==-1){var r=[t.indexOf(s.grouping),t.lastIndexOf(s.grouping)];if(r[0]==r[1]){return false}else{var q=new RegExp(("^"+s.grouping)+".*"+(s.grouping+"$"));if(t.match(q)&&t.match(new RegExp(s.grouping,"g")).length==2){return}else{t=c(t,s)}}}if(t.constructor===String){t=t.split(s.separator)}return t}function h(s,r){var s=s||"",q=j(r.tag).clone(true);q.find("input").siblings("span").html(d(s)).end().val(s).attr("name",r.name).attr("id",r.id);return q}function d(q){return q.replace(/\s/g,"&nbsp;").replace("<","&lt;")+"M"}}(jQuery));var Lib=Lib||{};Lib.FacebookUpload={token:null,userId:null,photos:[],defaultOptions:{pageTitle:"post a photo from Facebook",loading:"loading...",albumSingular:"album",albumPlural:"albums",pickAFacebookAlbum:"pick an album",pickAnotherOne:"pick another one",photoSingular:"photo",photoPlural:"photos",imgPath:"/images/default/"},options:{},ucfirst:function(b){b+="";var a=b.charAt(0).toUpperCase();return a+b.substr(1)},start:function(a){this.token=this.getAccessToken();if(this.token==null){return}this.options=jQuery.extend(this.defaultOptions,a);this.loadUser()},getAccessToken:function(){var a=null;if(window.location.hash.length>0){a=window.location.hash.substring(1)}return a},replaceFileInput:function(){$("#mediaHint").remove();$("#media").parent().prepend('			<div id="facebookPhotoExplorer">				<div class="loading">					<img src="/'+this.options.imgPath+'ajax-loader.gif" alt="" />					'+this.ucfirst(this.options.loading)+'				</div>				<div class="albums">					<p>'+this.ucfirst(this.options.pickAFacebookAlbum)+'</p>					<ul/>				</div>				<div class="photos">					<span class="albumTitle"></span>					<a href="#" class="back">('+this.options.pickAnotherOne+")</a>					<ul/>				</div>			</div>			").end().replaceWith('			<input type="text" id="media" name="media" readonly="readonly">			<input type="hidden" id="useRemoteFile" name="useRemoteFile" value="1">')},setUpClickHandlers:function(){var a=this;$("#facebookPhotoExplorer div.photos").click(function(b){$("#media").val(b.target.parentNode.rel);$(this).find("li").removeClass("selected");$(b.target.parentNode.parentNode).addClass("selected");return false});$("#facebookPhotoExplorer div.albums").click(function(c){var b=c.target.rel.split("|");a.getAlbumPhotos(c.target.text,b[0],b[1]);return false});$("#facebookPhotoExplorer div.photos a.back").click(function(){$("#facebookPhotoExplorer div.albums").show();$("#facebookPhotoExplorer div.photos").hide();$("#facebookPhotoExplorer div.photos ul").empty();return false})},loadScript:function(a,c){var b=document.createElement("script");b.type="text/javascript";if(typeof(c)!="undefined"){a+="&callback="+c}b.src=a;document.getElementsByTagName("head")[0].appendChild(b);$("#facebookPhotoExplorer div.albums, #facebookPhotoExplorer div.photos").hide();$("#facebookPhotoExplorer div.loading").show()},loadUser:function(){this.loadScript("https://graph.facebook.com/me?"+this.token,"Lib.FacebookUpload.proceed")},proceed:function(a){if(typeof(a.id)=="undefined"){alert("unauthorized");return}this.userId=a.id;$("div.addPhotoFacebook").remove();this.changeTitle();this.replaceFileInput();this.setUpClickHandlers();this.getAlbums()},changeTitle:function(){$("h1.albumTitle").text(this.ucfirst(this.options.pageTitle))},getAlbums:function(a){this.loadScript("https://graph.facebook.com/"+this.userId+"/albums/?"+this.token,"Lib.FacebookUpload.listAlbums")},listAlbums:function(e){this.albums=e.data;var h=document.createDocumentFragment();for(var f=0,c=this.albums.length;f<c;f++){if(typeof(this.albums[f].count)=="undefined"){continue}var b=document.createElement("li"),d=document.createElement("a"),g=document.createElement("span");g.className="count";g.appendChild(document.createTextNode(" ("+this.albums[f].count+" "+((this.albums[f].count>1)?this.options.photoPlural:this.options.photoSingular)+")"));d.appendChild(document.createTextNode(this.albums[f].name));d.href="#";d.rel=this.albums[f].id+"|"+this.albums[f].count+"|"+this.albums[f].link;d.className="album dataLink";b.appendChild(d);b.appendChild(g);h.appendChild(b)}$("#facebookPhotoExplorer div.loading").hide();$("#facebookPhotoExplorer div.albums ul").empty().get(0).appendChild(h);$("#facebookPhotoExplorer div.albums").show()},getAlbumPhotos:function(c,a,b){$("#facebookPhotoExplorer div.photos span.albumTitle").text(this.ucfirst(this.options.albumSingular)+": "+c);this.loadScript("https://graph.facebook.com/"+a+"/photos/?"+this.token+"&limit="+b,"Lib.FacebookUpload.showPhotos")},getUserPhotos:function(a){this.userId=a.id;this.loadScript("https://graph.facebook.com/"+this.userId+"/photos/?"+this.token,"Lib.FacebookUpload.showPhotos")},showPhotos:function(f){$("#facebookPhotoExplorer div.albums").hide();$("#facebookPhotoExplorer div.photos").show();this.photos=f.data;var j=document.createDocumentFragment();for(var h=0,c=this.photos.length;h<c;h++){var g=this.photos[h],b=document.createElement("li"),d=document.createElement("a"),e=document.createElement("img");d.href="#";d.rel=g.images[0].source;e.src=g.picture;d.appendChild(e);b.appendChild(d);j.appendChild(b)}$("#facebookPhotoExplorer div.loading").hide();$("#facebookPhotoExplorer div.photos ul").empty().show().get(0).appendChild(j)}};jQuery.cookie=function(d,e,b){if(arguments.length>1&&String(e)!=="[object Object]"){b=jQuery.extend({},b);if(e===null||e===undefined){b.expires=-1}if(typeof b.expires==="number"){var g=b.expires,c=b.expires=new Date();c.setDate(c.getDate()+g)}e=String(e);return(document.cookie=[encodeURIComponent(d),"=",b.raw?e:encodeURIComponent(e),b.expires?"; expires="+b.expires.toUTCString():"",b.path?"; path="+b.path:"",b.domain?"; domain="+b.domain:"",b.secure?"; secure":""].join(""))}b=e||{};var a,f=b.raw?function(h){return h}:decodeURIComponent;return(a=new RegExp("(?:^|; )"+encodeURIComponent(d)+"=([^;]*)").exec(document.cookie))?f(a[1]):null};