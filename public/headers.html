<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Headers</title>
<style>
 * {
 	margin: 0;
 	padding: 0;
 }
 html,
 body {
 	background: #eee;
 	font-size: 16px;
 }
 
 body {
 	position: relative;
 }
 
 a {
 	color: #f8f8f8;
 	text-decoration: none;
 	font-weight: bold;
 	display: inline-block;
 	padding: 1em;
 	margin: 0 .5em;
 	background: #aaa;
 }
 
 ul {
 	list-style: none;
 }
  
 .card {
    background: #f8f8f8;
	box-shadow: 0.0625em 0.0625em 0.0625em #404040;	
    padding: 1em;
    margin: 1em;
 }
 
 .headerCard {
 	display: flex;
 	flex-wrap: wrap;
 	justify-content: space-between;
 }
 
 .cardTitle {
 	display: inline-block;
 }
 
 .headerMenuAnchor {
 	display: none;
	width: 32px;
    border: none;
    background: transparent 	
 }
 
 .overlay {
 	display: none;
  	position: fixed;
 	z-index: 1;
 	top: 0;
 	bottom: 0;
 	left: 0;
 	right: 0;
 	background: rgba(0, 0, 0, .5);
 }
 
 .showModal .overlay {
 	display: flex;
 	align-items: center;
 	justify-content: center;
 }
 
 .modal {
 	max-width: 80vw;
 	max-height: 300px;
 	overflow-y: auto;
 	background: #aaa;
 }
 
 .modalNavLink {
 	display: block;
 	margin: 0;
 	background: #ccc;
 	color: #333;
 }
 
 .modalNavLink:hover {
 	background: #eee;
 }
 
 @media screen and (max-width: 667px) {
 	.cardWrapper .action,
 	.cardWrapper .subHeaderCardBottom {
 		display: none;
 	}
	 .headerMenuAnchor {
	 	display: inline-block;
	 }
 }
 
</style>
</head>
<body>

<div class="cardWrapper">
	<div class="card headerCard subHeaderCardTop">
		
		<div class="cardSectionLeft">
			<h1 class="cardTitle">The picture title</h1>
			<a class="action" aria-label="Rotate 90 degrees counter clockwise" href="/rotate/90">+90</a>
			<a class="action" aria-label="Rotate 90 degrees clockwise"href="/rotate/-90">-90</a>
			<a class="action" aria-label="Rotate 180 degrees"href="/rotate/180">180</a>
		</div>
		
		<div class="cardSectionRight">
			<a class="action" aria-label="Add a picture" href="/add/one">Add a picture</a>
			<button class="headerMenuAnchor" title="Menu">
				<svg version="1.1" viewBox="0 0 32 32" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
					<path d="M4,10h24c1.104,0,2-0.896,2-2s-0.896-2-2-2H4C2.896,6,2,6.896,2,8S2.896,10,4,10z M28,14H4c-1.104,0-2,0.896-2,2  s0.896,2,2,2h24c1.104,0,2-0.896,2-2S29.104,14,28,14z M28,22H4c-1.104,0-2,0.896-2,2s0.896,2,2,2h24c1.104,0,2-0.896,2-2  S29.104,22,28,22z"></path>
				</svg>                
			</button>		
		</div>
	</div>
	
	<div class="card headerCard subHeaderCardBottom">
		<div class="cardSectionLeft">
			<a class="action" aria-label="Previous picture" href="/prev/picture">Link to the picture to the left</a>
		</div>
		
		<div class="cardSectionRight">
			<a class="action" aria-label="Next picture" href="/next/picture">Link to the picture to the right</a>
		</div>
	</div>

</div>

<div class="overlay" id="overlay">
	<div class="modal" id="modal"></div>
</div>


<script>
(function() {
	var getAncestor = (function() {
		var el = HTMLElement.prototype;
		var matches = el.matches || el.webkitMatchesSelector || el.mozMatchesSelector || el.msMatchesSelector;

		return function getAncestor(el, selector) {
			if (matches.call(el, selector)) {
				return el;
			}
			if (!el.parentElement) {
				return null;
			}
			return getAncestor(el.parentElement, selector);
		};
	})();
	
	var onHeaderMenuClick = function(buttonEl) {
		// find all actions, build a list
		var carpWrapperEl = getAncestor(buttonEl, '.cardWrapper');
		if (!carpWrapperEl) {
			return;
		}
		var actionEls = carpWrapperEl.getElementsByClassName('action');
		var listEl = document.createElement('ul');
		for (var i = 0, l = actionEls.length; i < l; i++) {
			var listItemEl = document.createElement('li');
			listItemEl.classList.add('modalNavListItem');
			var linkEl = document.createElement('a');
			linkEl.classList.add('modalNavLink');
			linkEl.setAttribute('href', actionEls[i].getAttribute('href'));
			linkEl.innerText = actionEls[i].getAttribute('aria-label');
			listItemEl.appendChild(linkEl);
			listEl.appendChild(listItemEl);
		}
		
		var modalEl = document.getElementById('modal');
		modalEl.innerHTML = '';
		modalEl.appendChild(listEl);
		
		document.body.classList.add('showModal');		
	}
	
	var onOverlayClick = function() {
		document.body.classList.remove('showModal');		
	}
	
	
	// event delegation
	document.body.addEventListener('click', function(e) {
		var el		
		if (el = getAncestor(e.target, '.headerMenuAnchor')) {
			onHeaderMenuClick(el);
		} else if (getAncestor(e.target, '.overlay')) {
			onOverlayClick();
		}

	});
})()
</script>

</body>
</html>